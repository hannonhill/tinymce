!function(){var a={},b=function(b){for(var c=a[b],e=c.deps,f=c.defn,g=e.length,h=new Array(g),i=0;i<g;++i)h[i]=d(e[i]);var j=f.apply(null,h);if(void 0===j)throw"module ["+b+"] returned undefined";c.instance=j},c=function(b,c,d){if("string"!=typeof b)throw"module id must be a string";if(void 0===c)throw"no dependencies for "+b;if(void 0===d)throw"no definition function for "+b;a[b]={deps:c,defn:d,instance:void 0}},d=function(c){var d=a[c];if(void 0===d)throw"module ["+c+"] was undefined";return void 0===d.instance&&b(c),d.instance},e=function(a,b){for(var c=a.length,e=new Array(c),f=0;f<c;++f)e.push(d(a[f]));b.apply(null,b)},f={};f.bolt={module:{api:{define:c,require:e,demand:d}}};var g=c,h=function(a,b){g(a,[],function(){return b})};h("4",tinymce.util.Tools.resolve),g("1",["4"],function(a){return a("tinymce.PluginManager")}),g("5",["4"],function(a){return a("tinymce.util.VK")}),g("a",["4"],function(a){return a("tinymce.util.Delay")}),g("b",["4"],function(a){return a("tinymce.util.Tools")}),g("c",["4"],function(a){return a("tinymce.util.XHR")}),g("9",[],function(){var a=function(a){return"boolean"==typeof a.link_assume_external_targets&&a.link_assume_external_targets},b=function(a){return"boolean"==typeof a.link_context_toolbar&&a.link_context_toolbar},c=function(a){return a.link_list},d=function(a){return"string"==typeof a.default_link_target},e=function(a){return a.default_link_target},f=function(a){return a.target_list},g=function(a,b){a.settings.target_list=b},h=function(a){return f(a)!==!1},i=function(a){return a.rel_list},j=function(a){return void 0!==i(a)},k=function(a){return"object"!=typeof a.link_class_list[0]&&a.link_class_list.unshift({text:"None",value:""}),a.link_class_list},l=function(a){return void 0!==k(a)},m=function(a){return a.link_title!==!1},n=function(a){return"boolean"==typeof a.allow_unsafe_link_target&&a.allow_unsafe_link_target},o=function(a){return a.link_anchor!==!1};return{assumeExternalTargets:a,hasContextToolbar:b,getLinkList:c,hasDefaultLinkTarget:d,getDefaultLinkTarget:e,getTargetList:f,setTargetList:g,shouldShowTargetList:h,getRelList:i,hasRelList:j,getLinkClassList:k,hasLinkClassList:l,shouldShowLinkTitle:m,allowUnsafeLinkTarget:n,shouldShowLinkAnchor:o}}),h("d",RegExp),g("8",["b","9","d"],function(a,b,c){var d=function(b,c){var d=["noopener"],e=b?b.split(/\s+/):[],f=function(b){return a.trim(b.sort().join(" "))},g=function(a){return a=h(a),a.length?a.concat(d):d},h=function(b){return b.filter(function(b){return a.inArray(d,b)===-1})};return e=c?g(e):h(e),e.length?f(e):null},e=function(a){return a.replace(/\uFEFF/g,"")},f=function(a,b){return b=b||a.selection.getStart(),k(b)?a.dom.select("a[href]",b)[0]:a.dom.getParent(b,"a[href]")},g=function(a,b){var c=b?b.innerText||b.textContent:a.getContent({format:"text"});return e(c)},h=function(a){return a&&"A"===a.nodeName&&a.href},i=function(b){return a.grep(b,h).length>0},j=function(a){return!(/</.test(a)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(a)||a.indexOf("href=")==-1))},k=function(a){return a&&"FIGURE"===a.nodeName&&/\bimage\b/i.test(a.className)},l=function(a,c){return function(e){a.undoManager.transact(function(){var g=a.selection.getNode(),h=f(a,g),i={href:e.href,target:e.target?e.target:null,rel:e.rel?e.rel:null,"class":e["class"]?e["class"]:null,title:e.title?e.title:null};"internal"===e.source_type&&(i["data-mce-asset-id"]=r(a).id,i["data-mce-asset-type"]=r(a).type),b.hasRelList(a.settings)||b.allowUnsafeLinkTarget(a.settings)!==!1||(i.rel=d(i.rel,"_blank"==i.target)),e.href===c.href&&(c.attach(),c={}),h?(a.focus(),e.hasOwnProperty("text")&&("innerText"in h?h.innerText=e.text:h.textContent=e.text),a.dom.setAttribs(h,i),a.selection.select(h),a.undoManager.add()):k(g)?o(a,g,i):e.hasOwnProperty("text")?a.insertContent(a.dom.createHTML("a",i,a.dom.encode(e.text))):a.execCommand("mceInsertLink",!1,i)})}},m=function(a){return function(){a.undoManager.transact(function(){var b=a.selection.getNode();k(b)?n(a,b):a.execCommand("unlink")})}},n=function(a,b){var c,d;d=a.dom.select("img",b)[0],d&&(c=a.dom.getParents(d,"a[href]",b)[0],c&&(c.parentNode.insertBefore(d,c),a.dom.remove(c)))},o=function(a,b,c){var d,e;e=a.dom.select("img",b)[0],e&&(d=a.dom.create("a",c),e.parentNode.insertBefore(d,e),d.appendChild(e))},p=function(a){return a.replace(/\#/g,"")},q=function(a){return a.LinkAssetChooser},r=function(a){return q(a).getAssetFromChosen()},s=function(a,b){b.LinkAssetChooser=a},t=function(){return Cascade},u=function(){return $(document.getElementById("chooser-linkedAssetId"))},v=function(){return document.getElementById("linkedAssetPath")},w=function(a){return null!==a.match(/^(?:site:\/\/|\/)\w/)},x=function(a){return a.match(/^#$|[^#]+/g)||[]};return{link:l,unlink:m,isLink:h,hasLinks:i,isOnlyTextSelected:j,getAnchorElement:f,getAnchorText:g,toggleTargetRules:d,cleanAnchorText:p,getAssetChooser:q,setAssetChooser:s,getChosenFromAssetChooser:r,getGlobalCascadeVariable:t,getInternalLinkChooser:u,getInternalLinkChooserPathFieldElement:v,isInternalUrl:w,splitUrlByHash:x}}),g("6",["a","b","c","8","9"],function(a,b,c,d,e){var f={},g=function(a,b){var e="CONTEXT_PATH/linkpopup.act?href=<LINK_HREF>&currentSiteId="+d.getGlobalCascadeVariable().Variables.get("currentSiteId"),f=a.selection,g=a.dom,h=f.getNode(),i=g.getParent(h,"a[href]"),j=i?g.getAttrib(i,"href"):"";d.isInternalUrl(j)||(j=""),c.send({url:e.replace("<LINK_HREF>",encodeURIComponent(j)),error:function(){b(a,"")},success:function(c){b(a,c)}})},h=function(a,c,d){var e=function(a,b){return a.length>b?a.substr(0,b-1)+"...":a},f=function(a,d){var g;return d=d||[],b.each(a,function(a){"string"==typeof a&&(a={text:a,value:a}),g={text:a.text||a.title},g.text=e(g.text,50),a.menu?g.menu=f(a.menu):(g.value=a.value,c&&c(g)),d.push(g)}),d};return f(a,d||[])},i=function(b,c,d){var e=b.selection.getRng();a.setEditorTimeout(b,function(){b.windowManager.confirm(c,function(a){b.selection.setRng(e),d(a)})})},j=function(a,c){var g,j,k,l,m,n,o,p,q,r,s,t,u,v,w={},x=a.selection,y=a.dom,z=function(){var a=this.checked(),b=k.find("#"+("source_type_internal"===this.name()?"source_type_external":"source_type_internal"));return this.name()==="source_type_"+w.source_type?void this.checked(!0):(this.checked(a),b.checked(!a),"source_type_internal"===this.name()&&this.checked()?(k.find("#internalLink").show(),k.find("#externalLink").hide(),w.source_type="internal"):(k.find("#internalLink").hide(),k.find("#externalLink").show(),w.source_type="external"),void A())},A=function(){if(!j&&l&&!w.text){var b="internal"===w.source_type?d.getChosenFromAssetChooser(a).path:k.find("#externalLink").value(),c=d.cleanAnchorText(k.find("#anchor").value());""!==c&&(b+="#"+c),this.parent().parent().find("#text")[0].value(b)}},B=function(a){if(a.control&&this.value()){var b=d.splitUrlByHash(this.value());"externalLink"===this.name()?(this.value(b[0]),b[1]&&k.find("#anchor").value(b[1])):"anchor"===this.name()&&this.value(b[0]||b[1])}A.call(this)};if(l=d.isOnlyTextSelected(x.getContent()),g=d.getAnchorElement(a),w.text=j=d.getAnchorText(a.selection,g),w.href=g?y.getAttrib(g,"href"):"","#"===w.href)w.href="";else{var C=d.splitUrlByHash(w.href);C.length>1?(w.anchor=C[1]||"",""!==w.anchor&&(w.href=C[0])):w.href.startsWith("#")&&(w.anchor=C[0],w.href="")}w.source_type=d.isInternalUrl(w.href)||""===w.href?"internal":"external",g?w.target=y.getAttrib(g,"target"):e.hasDefaultLinkTarget(a.settings)&&(w.target=e.getDefaultLinkTarget(a.settings)),(r=y.getAttrib(g,"rel"))&&(w.rel=r),(r=y.getAttrib(g,"class"))&&(w["class"]=r),(r=y.getAttrib(g,"title"))&&(w.title=r),u={name:"externalLink",type:"textbox",size:40,label:"Link",value:"external"===w.source_type?w.href:"http://",onchange:B,onkeyup:A},c&&(v={type:"container",label:"Link Source",layout:"flex",direction:"row",align:"center",spacing:5,items:[{name:"source_type_internal",type:"checkbox",checked:"internal"===w.source_type,onclick:z,text:"Internal"},{name:"source_type_external",type:"checkbox",checked:"external"===w.source_type,onclick:z,text:"External"}]},u.hidden="external"!==w.source_type,u={type:"container",name:"linkContainer",label:"Link",minHeight:55,items:[u,{name:"internalLink",type:"container",hidden:"internal"!==w.source_type,html:c}]}),e.shouldShowLinkAnchor(a.settings)&&(s={name:"anchor",type:"textbox",label:"Anchor",size:40,onchange:B,onkeyup:A}),l&&(m={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){w.text=this.value()}}),e.shouldShowTargetList(a.settings)&&(void 0===e.getTargetList(a.settings)&&e.setTargetList(a,[{text:"None",value:""},{text:"New window",value:"_blank"}]),o={name:"target",type:"listbox",label:"Target",values:h(e.getTargetList(a.settings))}),e.hasRelList(a.settings)&&(n={name:"rel",type:"listbox",label:"Rel",values:h(e.getRelList(a.settings),function(b){e.allowUnsafeLinkTarget(a.settings)===!1&&(b.value=d.toggleTargetRules(b.value,"_blank"===w.target))})}),e.hasLinkClassList(a.settings)&&(w["class"]&&e.getLinkClassList(a.settings).indexOf(w["class"])===-1&&e.getLinkClassList(a.settings).push(w["class"]),p={name:"class",type:"listbox",label:"Class",style:"max-width:100%;",values:h(e.getLinkClassList(a.settings),function(b){b.value&&(b.textStyle=function(){return a.formatter.getCssText({inline:"a",classes:[b.value]})})})}),e.shouldShowLinkTitle(a.settings)&&(q={name:"title",type:"textbox",label:"Title",value:w.title}),k=a.windowManager.open({title:"Insert link",data:w,body:[v,u,s,m,q,n,o,p],onSubmit:function(c){var g=e.assumeExternalTargets(a.settings),h=d.link(a,f),k=d.unlink(a),m=b.extend({},w,c.data),n=m.href;if(m.source_type_internal){var o=d.getChosenFromAssetChooser(a).path,p=o.match(/(.*):([^\/].*)/);n=p?"site://"+p[1]+"/"+p[2]:o&&"/"!==o.charAt(0)?"/"+o:o}else n=m.externalLink;return m.anchor&&(n+="#"+d.cleanAnchorText(m.anchor)),""===n&&(n="#"),n?(l&&m.text!==j||delete m.text,n.indexOf("@")>0&&n.indexOf("//")==-1&&n.indexOf("mailto:")==-1?void i(a,"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(a){a&&(m.href="mailto:"+n),h(m)}):g===!0&&!/^\w+:/i.test(n)||g===!1&&/^\s*www[\.|\d\.]/i.test(n)?void i(a,"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(a){a&&(m.href="http://"+n),h(m)}):(m.href=n,void h(m))):void k()}}),t=d.getInternalLinkChooser(),d.setAssetChooser(t.assetChooser().data("cs.chooser"),a),t.on("clear.cs.chooser submit.cs.chooser.panel",function(){B.call(d.getInternalLinkChooserPathFieldElement(),{})})},k=function(a){g(a,j)};return{open:k}}),g("e",["4"],function(a){return a("tinymce.dom.DOMUtils")}),g("f",["4"],function(a){return a("tinymce.Env")}),g("7",["e","f"],function(a,b){var c=function(a,b){document.body.appendChild(a),a.dispatchEvent(b),document.body.removeChild(a)},d=function(d){if(!b.ie||b.ie>10){var e=document.createElement("a");e.target="_blank",e.href=d,e.rel="noreferrer noopener";var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),c(e,f)}else{var g=window.open("","_blank");if(g){g.opener=null;var h=g.document;h.open(),h.write('<meta http-equiv="refresh" content="0; url='+a.DOM.encode(d)+'">'),h.close()}}};return{open:d}}),g("2",["5","6","7","8","9"],function(a,b,c,d,e){var f=function(a,b){return a.dom.getParent(b,"a[href]")},g=function(a){return f(a,a.selection.getStart())},h=function(a){var b=a.getAttribute("data-mce-href");return b?b:a.getAttribute("href")},i=function(a){var b=a.getAttribute("data-mce-asset-id"),c=a.getAttribute("data-mce-asset-type");return b&&c?{id:b,type:c}:{}},j=function(a){var b=a.plugins.contextmenu;return!!b&&b.isContextMenuVisible()},k=function(a){return a.altKey===!0&&a.shiftKey===!1&&a.ctrlKey===!1&&a.metaKey===!1},l=function(a,b){var e="CONTEXT_PATH/entity/open.act";if(b){var f=h(b);if(/^#/.test(f)){var g=a.$(f);g.length&&a.selection.scrollIntoView(g[0],!0)}else if(d.isInternalUrl(f)){var j=i(b);j.id&&j.type&&c.open(e+"?id="+j.id+"&type="+j.type)}else c.open(b.href)}},m=function(a){return function(){b.open(a)}},n=function(a){return function(){l(a,g(a))}},o=function(a){return function(b){var c,f,g;return!!(e.hasContextToolbar(a.settings)&&!j(a)&&d.isLink(b)&&(c=a.selection,f=c.getRng(),g=f.startContainer,3==g.nodeType&&c.isCollapsed()&&f.startOffset>0&&f.startOffset<g.data.length))}},p=function(b){b.on("click",function(c){var d=f(b,c.target);d&&a.metaKeyPressed(c)&&(c.preventDefault(),l(b,d))}),b.on("keydown",function(a){var c=g(b);c&&13===a.keyCode&&k(a)&&(a.preventDefault(),l(b,c))})},q=function(a){return function(){var b=this;a.on("nodechange",function(c){b.active(!a.readonly&&!!d.getAnchorElement(a,c.element))})}},r=function(a){return function(){var b=this,c=function(a){d.hasLinks(a.parents)?b.show():b.hide()};d.hasLinks(a.dom.getParents(a.selection.getStart()))||b.hide(),a.on("nodechange",c),b.on("remove",function(){a.off("nodechange",c)})}};return{openDialog:m,gotoSelectedLink:n,leftClickedOnAHref:o,setupGotoLinks:p,toggleActiveState:q,toggleViewLinkState:r}}),g("3",["2","8"],function(a,b){var c=function(c){c.addButton("link",{icon:"link",tooltip:"Insert/edit link",shortcut:"Meta+K",onclick:a.openDialog(c),onpostrender:a.toggleActiveState(c)}),c.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onclick:b.unlink(c),onpostrender:a.toggleActiveState(c)}),c.addContextToolbar&&c.addButton("openlink",{icon:"newtab",tooltip:"Open link",onclick:a.gotoSelectedLink(c)})},d=function(b){b.addMenuItem("openlink",{text:"Open link",icon:"newtab",onclick:a.gotoSelectedLink(b),onPostRender:a.toggleViewLinkState(b),prependToContext:!0}),b.addMenuItem("link",{icon:"link",text:"Link",shortcut:"Meta+K",onclick:a.openDialog(b),stateSelector:"a[href]",context:"insert",prependToContext:!0})},e=function(b){b.addContextToolbar&&b.addContextToolbar(a.leftClickedOnAHref(b),"openlink | link unlink")};return{setupButtons:c,setupMenuItems:d,setupContextToolbars:e}}),g("0",["1","2","3"],function(a,b,c){return a.add("link",function(a){c.setupButtons(a),c.setupMenuItems(a),c.setupContextToolbars(a),b.setupGotoLinks(a),a.on("preInit",function(){a.serializer.addAttributeFilter("data-mce-asset-id",function(a,b){for(var c,d=a.length;d--;)c=a[d],c.attr("data-mce-asset-id",null),c.attr("data-mce-asset-type",null)})}),a.addShortcut("Meta+K","",b.openDialog(a)),a.addCommand("mceLink",b.openDialog(a))}),function(){}}),d("0")()}();